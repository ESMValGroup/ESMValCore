FROM continuumio/miniconda3

# update the conda packages
RUN conda update -y conda pip

# install development tools
RUN apt-get update -y && apt-get install -y \
    build-essential \
    curl \
    unzip

# install environment packages
COPY . /source
WORKDIR /source
RUN ls
RUN conda env update --name base --file environment.yml
RUN pip install -e .[develop]
RUN pip freeze
RUN pip uninstall esmvalcore
RUN pip freeze
